<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>go</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="icon" type="image/png" href="../images/icon.png">

<style>
@font-face {
  font-family: "RuneScape UF";
  src: url("../fonts/RuneScape-UF.woff2") format("woff2"),
       url("../fonts/RuneScape-UF.woff") format("woff");
}

html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: white;
  font-family: "RuneScape UF", Arial, sans-serif;

  -webkit-user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  user-select: none;
}

html, body {
  cursor: url("../images/cursor/cursor.png"), auto;
}

button,
input {
  cursor: url("../images/cursor/cursor-hover.png"), pointer;
}


/* PASSWORD SCREEN */
.password-screen {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  background: white;
  transition: opacity 0.4s ease;
}

.password-hint {
  font-size: 18px;
  text-align: center;
  margin-top: 24px;
}

.password-box {
  text-align: center;
}

.password-box label {
  font-size: 32px;
  margin-bottom: 12px;
  display: block;
}

.password-box input {
  font-family: "RuneScape UF", Arial, sans-serif;
  font-size: 24px;
  padding: 8px 12px;
  border: 2px solid black;
  background: white;
  outline: none;
  text-align: center;
}

/* CONTENT PAGE */
.content-page {
  display: none;
  width: 100%;
  height: 100%;
  background: white;
}

.content-wrapper {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

/* VIDEO */
.video-wrapper {
  position: relative;
  width: 100%;
  max-width: 854px;
  aspect-ratio: 854 / 480;
  background: white;
  opacity: 0;
  transition: opacity 1s ease;
  display: none;
}

video {
  width: 100%;
  height: 100%;
  object-fit: contain;
  display: block;
}

@media (min-width: 1200px) {
  .video-wrapper {
    max-width: 1000px;
  }
}

/* ===== MOBILE SCALE OVERRIDE (ONLY FOR SPECIFIC VIDEOS) ===== */
@media (max-width: 768px) {
  .video-wrapper.mobile-fill {
    width: 100vw;
    max-width: none;
    height: calc(100vh - 56px); /* leave space for back button area */
    aspect-ratio: auto;         /* don't force 16:9 */
  }
}
/* ===== END MOBILE SCALE OVERRIDE ===== */

/* PLAY BUTTON */
.play-button {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 52px;
  color: #2d93ea;
  background: transparent;
  border: none;
  text-transform: lowercase;
  opacity: 0;
  transition: opacity 0.4s ease;
  z-index: 10;
  font-family: "RuneScape UF", Arial, sans-serif;
  pointer-events: none;
}

.play-button.show {
  opacity: 1;
  pointer-events: auto;
}

/* BACK BUTTON */
.back-button {
  position: fixed;
  top: 8px;
  left: 8px;
  font-size: 28px;
  background: transparent;
  border: none;
  color: #2d93ea;
  font-family: "RuneScape UF", Arial, sans-serif;
  text-transform: lowercase;
  padding: 0;
  z-index: 10;
}

.back-button.show {
  opacity: 1;
}
</style>
</head>

<body>

<div class="password-screen" id="passwordScreen">
  <div class="password-box">
    <label>password:</label>
    <input type="password" id="passwordInput" autocomplete="off">
    <div class="password-hint">hint: home</div>
  </div>
</div>

<div class="content-page" id="contentPage">
  <div class="content-wrapper">

    <button class="back-button" id="backButton">‚Üê back</button>

    <div class="video-wrapper" id="videoWrapper">
      <video id="videoElement" playsinline disablePictureInPicture controlsList="nodownload nofullscreen noremoteplayback"></video>
    </div>

    <button class="play-button" id="playButton">play</button>
  </div>
</div>

<script>
const passwordInput = document.getElementById("passwordInput");
const passwordScreen = document.getElementById("passwordScreen");
const contentPage = document.getElementById("contentPage");
const playButton = document.getElementById("playButton");
const videoWrapper = document.getElementById("videoWrapper");
const video = document.getElementById("videoElement");
const backButton = document.getElementById("backButton");

let currentAction = null;
let endedListener = null;

const actions = {
  "donovan": { src: "videos/video.mp4" },
  "gambosi": { src: "videos/skud.mp4" },
  "wasted": { src: "videos/litty.mp4" },

  "tinny": { redirect: "scale/scale.html", sameTab: true },
  "bag": { redirect: "game/boom.html", sameTab: true },
  "home": { redirect: "../home.html", sameTab: true },
  "rick": { redirect: "https://www.youtube.com/watch?v=dQw4w9WgXcQ", sameTab: false },
  "onway": { redirect: "stoneinfocus/stoneinfocus.html", sameTab: true },
  "deathstar": { redirect: "couchburnsimulator/couch.html", sameTab: true },

  /* NEW VIDEOS: only these get the mobile scaling class */
  "1millionfrogs": { src: "videos/1millionfrogs.mp4", mobileFill: true },
  "heavychest": { src: "videos/andre.mov", mobileFill: true }
};

function resetToPassword() {
  if (endedListener) video.removeEventListener("ended", endedListener);
  video.pause();
  video.removeAttribute("src");
  video.load();

  backButton.classList.remove("show");

  contentPage.style.display = "none";
  passwordScreen.style.display = "flex";
  passwordScreen.style.opacity = 1;

  videoWrapper.style.display = "none";
  videoWrapper.style.opacity = 0;

  // IMPORTANT: remove the per-video mobile class when leaving
  videoWrapper.classList.remove("mobile-fill");

  playButton.classList.remove("show");
  playButton.onclick = null;

  passwordInput.disabled = false;
  passwordInput.value = "";
  passwordInput.focus();
}

/* ===== FIX FOR BROWSER BACK BUTTON / BFCache RESTORE ===== */
function hardResetPasswordUI() {
  if (endedListener) video.removeEventListener("ended", endedListener);

  video.pause();
  video.removeAttribute("src");
  video.load();

  currentAction = null;
  endedListener = null;

  contentPage.style.display = "none";
  passwordScreen.style.display = "flex";
  passwordScreen.style.opacity = 1;

  videoWrapper.style.display = "none";
  videoWrapper.style.opacity = 0;

  // IMPORTANT: remove the per-video mobile class on restore
  videoWrapper.classList.remove("mobile-fill");

  playButton.classList.remove("show");
  playButton.onclick = null;
  backButton.classList.remove("show");

  passwordInput.disabled = false;
  passwordInput.value = "";
  passwordInput.setAttribute("value", "");

  requestAnimationFrame(() => passwordInput.focus());
}

window.addEventListener("pageshow", () => {
  hardResetPasswordUI();
});

window.addEventListener("pagehide", () => {
  passwordInput.disabled = false;
});
/* ===== END FIX ===== */

backButton.onclick = resetToPassword;

passwordInput.addEventListener("keydown", e => {
  if (e.key !== "Enter") return;

  const key = passwordInput.value.toLowerCase();
  const action = actions[key];
  if (!action) {
    passwordInput.value = "";
    return;
  }

  passwordInput.disabled = true;

  if (action.redirect) {
    const sameTab = action.sameTab !== false;
    passwordInput.disabled = false;
    passwordInput.value = "";

    if (sameTab) window.location.href = action.redirect;
    else window.open(action.redirect, "_blank");
    return;
  }

  currentAction = action;

  passwordScreen.style.opacity = 0;
  setTimeout(() => passwordScreen.style.display = "none", 400);

  contentPage.style.display = "block";
  playButton.classList.add("show");

  playButton.onclick = () => {
    playButton.classList.remove("show");

    videoWrapper.style.display = "block";
    videoWrapper.style.opacity = 0;
    backButton.classList.add("show");

    // ===== APPLY MOBILE CLASS ONLY FOR SELECTED VIDEOS =====
    if (currentAction.mobileFill) videoWrapper.classList.add("mobile-fill");
    else videoWrapper.classList.remove("mobile-fill");
    // ===== END =====

    video.src = currentAction.src + "?v=" + Date.now();
    video.currentTime = 0;

    requestAnimationFrame(() => {
      videoWrapper.style.opacity = 1;
      video.play().catch(() => {});
    });

    endedListener = resetToPassword;
    video.addEventListener("ended", endedListener, { once: true });
  };
});

document.addEventListener("contextmenu", e => e.preventDefault());
</script>

</body>
</html>
