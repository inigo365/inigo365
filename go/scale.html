<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>scale</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
@font-face {
  font-family: "RuneScape UF";
  src: url("../fonts/RuneScape-UF.woff2") format("woff2"),
       url("../fonts/RuneScape-UF.woff") format("woff");
}

html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: white;
  font-family: "RuneScape UF", Arial, sans-serif;
  user-select: none;
  cursor: url("../images/cursor/cursor.png"), auto;
}

.back-button {
  position: absolute;
  top: 8px;
  left: 8px;
  font-size: 28px;
  background: transparent;
  border: none;
  color: #2d93ea;
  font-family: "RuneScape UF", Arial, sans-serif;
  cursor: url("../images/cursor/cursor-hover.png"), pointer;
  text-transform: lowercase;
  padding: 0;
}

/* SCALE */
.scale-wrapper {
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.weight {
  font-size: 72px;
  color: #2d93ea;
  margin-bottom: 20px;
}

.instruction {
  font-size: 22px;
  color: #2d93ea;
}

/* MEDIA (hidden until triggered) */
.media {
  position: absolute;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  background: white;
  z-index: 5;
}

.media video {
  max-width: 90%;
  max-height: 90%;
}
</style>
</head>

<body>

<button class="back-button" onclick="goBack()">‚Üê back</button>

<div class="scale-wrapper">
  <div class="weight" id="weight">0.0g</div>
  <div class="instruction">click &amp; hold to weigh</div>
</div>

<!-- MEDIA PLACEHOLDER -->
<div class="media" id="media">
  <video id="mediaVideo" playsinline muted>
    <!-- ADD YOUR FILE HERE LATER -->
    <!-- <source src="example.mp4" type="video/mp4"> -->
    <!-- <img src="your-gif.gif" alt=""> -->
  </video>
</div>

<script>
let currentWeight = 0;
let targetWeight = 0;
let holding = false;
let mediaPlayed = false;

const weightEl = document.getElementById("weight");
const media = document.getElementById("media");
const mediaVideo = document.getElementById("mediaVideo");

function updateDisplay() {
  weightEl.textContent = currentWeight.toFixed(1) + "g";
}

function animate() {
  if (holding) {
    targetWeight = 1.0;
    currentWeight += (targetWeight - currentWeight) * 0.02;
  } else {
    targetWeight = 0;
    currentWeight += (targetWeight - currentWeight) * 0.15;
  }

  if (currentWeight > 1) currentWeight = 1;
  if (currentWeight < 0.01 && !holding) currentWeight = 0;

  if (currentWeight >= 0.99 && !mediaPlayed) {
    mediaPlayed = true;
    showMedia();
  }

  if (currentWeight === 0 && mediaPlayed) {
    resetMedia();
  }

  updateDisplay();
  requestAnimationFrame(animate);
}

function showMedia() {
  media.style.display = "flex";
  mediaVideo.currentTime = 0;
  mediaVideo.play().catch(() => {});
}

function resetMedia() {
  mediaPlayed = false;
  media.style.display = "none";
  mediaVideo.pause();
  mediaVideo.currentTime = 0;
}

document.addEventListener("mousedown", () => holding = true);
document.addEventListener("mouseup", () => holding = false);
document.addEventListener("touchstart", () => holding = true, { passive: true });
document.addEventListener("touchend", () => holding = false, { passive: true });

function goBack() {
  window.location.href = "index.html";
}

animate();
</script>

</body>
</html>
